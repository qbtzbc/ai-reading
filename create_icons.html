<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>AI Reading Icon Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .preview {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            align-items: center;
        }
        .icon-preview {
            text-align: center;
        }
        canvas {
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>AI Reading 图标生成器</h1>
        <p>为Chrome扩展生成图标文件</p>
        
        <div class="preview" id="preview"></div>
        
        <button onclick="generateIcons()">生成图标</button>
        <button onclick="downloadAll()">下载所有图标</button>
        
        <div id="status"></div>
    </div>

    <script>
        let generatedIcons = {};
        
        // 创建AI Reading图标
        function createIcon(size) {
            const canvas = document.createElement('canvas');
            canvas.width = size;
            canvas.height = size;
            const ctx = canvas.getContext('2d');
            
            // 清除画布
            ctx.clearRect(0, 0, size, size);
            
            // 绘制圆形背景
            const margin = Math.floor(size / 8);
            const radius = (size - margin * 2) / 2;
            const centerX = size / 2;
            const centerY = size / 2;
            
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.fillStyle = '#4CAF50';
            ctx.fill();
            
            // 绘制书本图标
            if (size >= 32) {
                const bookWidth = Math.floor(size / 2.5);
                const bookHeight = Math.floor(size / 3.5);
                const bookX = (size - bookWidth) / 2;
                const bookY = (size - bookHeight) / 2;
                
                // 书本背景
                ctx.fillStyle = 'white';
                ctx.fillRect(bookX, bookY, bookWidth, bookHeight);
                
                // 书页线条
                ctx.strokeStyle = '#333';
                ctx.lineWidth = Math.max(1, size / 48);
                const lineSpacing = bookHeight / 4;
                for (let i = 1; i < 3; i++) {
                    const y = bookY + i * lineSpacing;
                    ctx.beginPath();
                    ctx.moveTo(bookX + 2, y);
                    ctx.lineTo(bookX + bookWidth - 2, y);
                    ctx.stroke();
                }
                
                // 书脊
                ctx.strokeStyle = '#333';
                ctx.lineWidth = Math.max(1, size / 48);
                ctx.beginPath();
                ctx.moveTo(bookX, bookY);
                ctx.lineTo(bookX, bookY + bookHeight);
                ctx.stroke();
            } else {
                // 小尺寸图标简化为书本轮廓
                const dotSize = size / 3;
                ctx.fillStyle = 'white';
                ctx.fillRect(centerX - dotSize/2, centerY - dotSize/2, dotSize, dotSize * 0.7);
            }
            
            return canvas;
        }
        
        function generateIcons() {
            const sizes = [16, 32, 48, 128];
            const preview = document.getElementById('preview');
            preview.innerHTML = '';
            generatedIcons = {};
            
            sizes.forEach(size => {
                const canvas = createIcon(size);
                generatedIcons[size] = canvas;
                
                const container = document.createElement('div');
                container.className = 'icon-preview';
                container.innerHTML = `<div>${size}x${size}</div>`;
                container.appendChild(canvas);
                preview.appendChild(container);
            });
            
            document.getElementById('status').innerHTML = '<p style="color: green;">图标生成成功！点击"下载所有图标"保存文件。</p>';
        }
        
        function downloadAll() {
            if (Object.keys(generatedIcons).length === 0) {
                alert('请先生成图标！');
                return;
            }
            
            Object.entries(generatedIcons).forEach(([size, canvas]) => {
                canvas.toBlob(blob => {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.download = `icon${size}.png`;
                    link.href = url;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                }, 'image/png');
            });
            
            document.getElementById('status').innerHTML = '<p style="color: green;">所有图标已下载完成！请将它们复制到icons/目录中。</p>';
        }
        
        // 页面加载时自动生成图标
        window.onload = function() {
            generateIcons();
        };
    </script>
</body>
</html>